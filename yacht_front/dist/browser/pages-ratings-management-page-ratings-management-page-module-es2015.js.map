{"version":3,"sources":["./src/app/modules/dashboard/pages/ratings-management-page/ratings-management-page.component.ts","./src/app/modules/dashboard/pages/ratings-management-page/ratings-management-page.component.html","./src/app/modules/dashboard/pages/ratings-management-page/components/ratings-form-block/ratings-form-block.component.ts","./src/app/modules/dashboard/pages/ratings-management-page/components/ratings-form-block/ratings-form-block.component.html","./src/app/modules/dashboard/pages/ratings-management-page/ratings-management-page.module.ts","./src/app/modules/dashboard/pages/ratings-management-page/ratings-management-page-routing.module.ts"],"names":[],"mappings":"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","file":"pages-ratings-management-page-ratings-management-page-module-es2015.js","sourcesContent":["import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { IRatingData } from '@api/schemas/dashboard/ratings-data.interface';\nimport { AdministrationService } from '@api/routes/administration.service';\nimport { AbstractComponent } from '@shared/classes/abstract-component.class';\nimport { takeUntil } from 'rxjs/operators';\nimport { SidebarWrapperService } from '@layout/sidebar-wrapper/sidebar-wrapper.service';\n\n@Component({\n  selector: 'app-ratings-management-page',\n  templateUrl: './ratings-management-page.component.html',\n  styleUrls: ['./ratings-management-page.component.scss'],\n})\nexport class RatingsManagementPageComponent extends AbstractComponent implements OnInit, OnDestroy {\n  public data: IRatingData;\n  public saved = false;\n\n  constructor(\n    private readonly administrationService: AdministrationService,\n    private readonly sidebarWrapperService: SidebarWrapperService\n  ) {\n    super();\n  }\n\n  ngOnInit(): void {\n    setTimeout(() => {\n      this.sidebarWrapperService.params$.next({ article: false, trending: false, navigation: false, live: false, showSidebar: false });\n    });\n    this.getData();\n  }\n\n  private getData(): void {\n    this.administrationService.getRatings$().pipe(takeUntil(this.ngOnDestroy$)).subscribe((_: IRatingData) => {\n      this.data = _;\n    });\n  }\n\n  public postDataReq(): void {\n    this.administrationService.postRatings$(this.data).pipe(takeUntil(this.ngOnDestroy$)).subscribe(() => {\n      this.saved = true;\n      setTimeout(() => {\n        this.saved = false;\n      }, 5000);\n    });\n  }\n}\n","<app-ratings-form-block [(data)]=\"data\" [saved]=\"saved\" (submitReq)=\"postDataReq()\"></app-ratings-form-block>\n","import {\n  Component,\n  Input,\n  OnChanges,\n  SimpleChanges,\n  Output,\n  EventEmitter,\n  ChangeDetectionStrategy\n} from '@angular/core';\nimport { IRatingData } from '@api/schemas/dashboard/ratings-data.interface';\nimport { ISelectItem } from '@modules/dashboard/shared/ui/dashboard-select/select-item.interface';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\n\n@Component({\n  selector: 'app-ratings-form-block',\n  templateUrl: './ratings-form-block.component.html',\n  styleUrls: ['./ratings-form-block.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class RatingsFormBlockComponent implements OnChanges {\n  @Input() public data: IRatingData;\n  @Input() public saved = false;\n\n  @Output() public readonly dataChange: EventEmitter<IRatingData> = new EventEmitter<IRatingData>();\n  @Output() public readonly submitReq: EventEmitter<void> = new EventEmitter<void>();\n\n  public avarageItems: ISelectItem[] = [\n    {\n      title: 'Медиана',\n      id: 0,\n      payload: 'MEDIAN',\n    },\n    {\n      title: 'Среднее арифметическое',\n      id: 1,\n      payload: 'MEAN',\n    },\n  ];\n  public selectedAvarage: ISelectItem = this.avarageItems[0];\n  public resetData: IRatingData = null;\n  public form: FormGroup;\n\n  constructor(private fb: FormBuilder) {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.data) {\n      if (this.data) {\n        if (this.resetData === null) {\n          this.resetData = { ...this.data };\n        }\n        this.parseAvarage(this.data.userRanking);\n\n        this.form = this.fb.group({\n          views: [this.data.views, [Validators.required, Validators.min(0)]],\n          comments: [this.data.comments, [Validators.required, Validators.min(0)]],\n          favourites: [this.data.favourites, [Validators.required, Validators.min(0)]],\n          likes: [this.data.likes, [Validators.required, Validators.min(0)]],\n          dislikes: [this.data.dislikes, [Validators.required, Validators.min(0)]],\n          factor1: [this.data.factor1, [Validators.required, Validators.min(0)]],\n          factor2: [this.data.factor2, [Validators.required, Validators.min(0)]],\n          divider: [this.data.divider, [Validators.required, Validators.min(0)]],\n          days: [this.data.days, [Validators.required, Validators.min(0)]],\n        });\n      }\n    }\n  }\n\n  private parseAvarage(avarage: string): void {\n    switch (avarage) {\n      case 'MEAN':\n        this.selectedAvarage = this.avarageItems[1];\n        break;\n      case 'MEDIAN':\n        this.selectedAvarage = this.avarageItems[0];\n        break;\n    }\n  }\n\n  public submit(): void {\n    this.data.userRanking = this.selectedAvarage.payload;\n    this.dataChange.emit({...this.form.getRawValue(), userRanking: this.data.userRanking});\n    this.submitReq.emit();\n  }\n\n  public reset(): void {\n    this.data = { ...this.resetData };\n    this.dataChange.emit(this.data);\n    this.parseAvarage(this.data.userRanking);\n  }\n}\n","<form *ngIf=\"form\" class=\"admin-form\" [formGroup]=\"form\">\n    <h3 class=\"admin-blc__subtitle\">Коэффициенты для расчета</h3>\n    <fieldset class=\"admin-form__fieldset\">\n        <label class=\"admin-input-row\">\n            <span class=\"admin-input-row__title\">Просмотры</span>\n            <span class=\"admin-input-row__inputgroup\">\n                <input type=\"number\"\n                       class=\"admin-input admin-input_short admin-input-row__input\"\n                       name=\"views\"\n                       [min]=\"0\"\n                       formControlName=\"views\">\n            </span>\n        </label>\n        <label class=\"admin-input-row\">\n            <span class=\"admin-input-row__title\">{{ 'COMMON.COMMENTS' | translate }}</span>\n            <span class=\"admin-input-row__inputgroup\">\n                <input type=\"number\"\n                       class=\"admin-input admin-input_short admin-input-row__input\"\n                       name=\"comments\"\n                       [min]=\"0\"\n                       formControlName=\"comments\">\n            </span>\n        </label>\n        <label class=\"admin-input-row\">\n            <span class=\"admin-input-row__title\">{{ 'COMMON.FAVORITES' | translate }}</span>\n            <span class=\"admin-input-row__inputgroup\">\n                <input type=\"number\"\n                       class=\"admin-input admin-input_short admin-input-row__input\"\n                       name=\"fav\"\n                       [min]=\"0\"\n                       formControlName=\"favourites\">\n            </span>\n        </label>\n        <label class=\"admin-input-row\">\n            <span class=\"admin-input-row__title\">Лайки</span>\n            <span class=\"admin-input-row__inputgroup\">\n                <input type=\"number\"\n                       class=\"admin-input admin-input_short admin-input-row__input\"\n                       name=\"likes\"\n                       [min]=\"0\"\n                       formControlName=\"likes\">\n            </span>\n        </label>\n        <label class=\"admin-input-row\">\n            <span class=\"admin-input-row__title\">Дизлайки</span>\n            <span class=\"admin-input-row__inputgroup\">\n                <input type=\"number\"\n                       class=\"admin-input admin-input_short admin-input-row__input\"\n                       name=\"dislikes\"\n                       [min]=\"0\"\n                       formControlName=\"dislikes\">\n            </span>\n        </label>\n        <label class=\"admin-input-row\">\n            <span class=\"admin-input-row__title\">Фактор 1</span>\n            <span class=\"admin-input-row__inputgroup\">\n                <input type=\"number\"\n                       class=\"admin-input admin-input_short admin-input-row__input\"\n                       name=\"factor1\"\n                       [min]=\"0\"\n                       formControlName=\"factor1\">\n            </span>\n        </label>\n        <label class=\"admin-input-row\">\n            <span class=\"admin-input-row__title\">Фактор 2</span>\n            <span class=\"admin-input-row__inputgroup\">\n                <input type=\"number\"\n                       class=\"admin-input admin-input_short admin-input-row__input\"\n                       name=\"factor2\"\n                       [min]=\"0\"\n                       formControlName=\"factor2\">\n            </span>\n        </label>\n        <label class=\"admin-input-row\">\n            <span class=\"admin-input-row__title\">Делитель</span>\n            <span class=\"admin-input-row__inputgroup\">\n                <input type=\"number\"\n                       class=\"admin-input admin-input_short admin-input-row__input\"\n                       name=\"divider\"\n                       [min]=\"0\"\n                       formControlName=\"divider\">\n            </span>\n        </label>\n    </fieldset>\n    <h2 class=\"admin-blc__title\">{{ 'COMMON.AUTHORS_RATING' | translate }}</h2>\n    <fieldset class=\"admin-form__fieldset\">\n        <label class=\"admin-input-row\">\n            <span class=\"admin-input-row__title\">Разновидность среднего значения</span>\n            <span class=\"admin-input-row__inputgroup\">\n                <app-dashboard-select [(selected)]=\"selectedAvarage\"\n                                      [items]=\"avarageItems\"\n                                      [dropdownWidth]=\"250\">\n                </app-dashboard-select>\n            </span>\n        </label>\n        <label class=\"admin-input-row\">\n            <span class=\"admin-input-row__title\">Период расчета</span>\n            <span class=\"admin-input-row__inputgroup\">\n                <input type=\"number\"\n                       class=\"admin-input admin-input_short admin-input-row__input\"\n                       name=\"days\"\n                       [min]=\"0\"\n                       formControlName=\"days\">\n                &nbsp;дней\n            </span>\n        </label>\n    </fieldset>\n    <div class=\"admin-form__bar\">\n        <button class=\"btn admin-btn_white\"\n                type=\"submit\" [disabled]=\"form.invalid\"\n                (click)=\"submit()\">\n            {{ saved ? 'Изменения сохранены' : 'Сохранить изменения' }}\n        </button>\n        <button class=\"btn admin-btn_blue\" (click)=\"reset()\">{{ 'COMMON.UNDO' | translate }}</button>\n    </div>\n</form>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { RatingsManagementPageRoutingModule } from './ratings-management-page-routing.module';\nimport { RatingsManagementPageComponent } from './ratings-management-page.component';\nimport { RatingsFormBlockComponent } from './components/ratings-form-block/ratings-form-block.component';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { DashboardSelectModule } from '@modules/dashboard/shared/ui/dashboard-select/dashboard-select.module';\n\n@NgModule({\n  declarations: [\n      RatingsManagementPageComponent,\n      RatingsFormBlockComponent\n  ],\n  imports: [\n      CommonModule,\n      RatingsManagementPageRoutingModule,\n      FormsModule,\n      DashboardSelectModule,\n      TranslateModule,\n      ReactiveFormsModule\n    ],\n})\nexport class RatingsManagementPageModule {}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { RatingsManagementPageComponent } from './ratings-management-page.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: RatingsManagementPageComponent,\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class RatingsManagementPageRoutingModule {}\n"],"sourceRoot":"webpack:///"}