{"version":3,"sources":["./src/app/modules/user/pages/user-comments-page/user-comments-page.component.ts","./src/app/modules/user/pages/user-comments-page/user-comments-page.component.html","./src/app/shared/functions/extract-query.function.ts","./src/app/modules/user/pages/user-comments-page/user-comments-page-routing.module.ts","./src/app/shared/enums/comments-range.enum.ts","./src/app/modules/user/pages/user-comments-page/user-comments-page.module.ts"],"names":[],"mappings":"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","file":"pages-user-comments-page-user-comments-page-module-es2015.js","sourcesContent":["import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { ICommentViewFeed } from '@api/schemas/comment/comment-view-feed.interface';\nimport { Observable, Subject } from 'rxjs';\nimport { AbstractComponent } from '@shared/classes/abstract-component.class';\nimport { UsersService } from '@api/routes/users.service';\nimport { ActivatedRoute, Router, ParamMap } from '@angular/router';\nimport { IUserViewFull } from '@api/schemas/user/user-view-full.interface';\nimport { takeUntil, map, first, switchMap, tap } from 'rxjs/operators';\nimport { IPageResponse } from '@api/schemas/page/page-response.interface';\nimport { SidebarWrapperService } from '@layout/sidebar-wrapper/sidebar-wrapper.service';\nimport { IToggleItem } from '@shared/interfaces/toggle-item.interface';\nimport { ECommentsRange } from '@shared/enums/comments-range.enum';\nimport { TranslateService } from '@ngx-translate/core';\nimport { extractQuery } from '@shared/functions/extract-query.function';\n\n@Component({\n  selector: 'app-user-comments-page',\n  templateUrl: './user-comments-page.component.html',\n  styleUrls: ['./user-comments-page.component.scss']\n})\nexport class UserCommentsPageComponent extends AbstractComponent implements OnInit, OnDestroy {\n  private readonly onFilter$: Subject<number> = new Subject<number>();\n\n  public readonly ranges: IToggleItem<ECommentsRange, { order: ECommentsRange }>[] = [\n    {\n      id: 0,\n      text: this.translateService.instant('COMMON.BY_ORDER'),\n      query: () => ({\n        order: ECommentsRange.CREATED\n      })\n    },\n    {\n      id: 1,\n      text: this.translateService.instant('COMMON.POPULAR_FIRST'),\n      query: () => ({\n        order: ECommentsRange.RATING\n      })\n    }\n  ];\n\n  public activeRange = 0;\n  public selectedRange: IToggleItem = this.ranges[0];\n  public userComments: ICommentViewFeed[] = [];\n  public maxPages = 0;\n  public page = 0;\n  public isLoadingNextPage = false;\n  public user$: Observable<IUserViewFull>;\n  public id$: Observable<number>;\n  public user: IUserViewFull;\n\n  constructor(\n    private readonly usersService: UsersService,\n    private readonly activatedRoute: ActivatedRoute,\n    private readonly sidebarWrapperService: SidebarWrapperService,\n    private readonly translateService: TranslateService,\n    public readonly router: Router,\n  ) {\n    super();\n  }\n\n  ngOnInit(): void {\n    setTimeout(() => {\n      this.sidebarWrapperService.params$.next({ article: false, trending: true, navigation: true, live: false, showSidebar: true });\n    });\n\n    this.onFilter$.pipe(takeUntil(this.ngOnDestroy$)).subscribe(() => this.reset());\n\n    const idOrName$: Observable<string | number> = this.activatedRoute.paramMap.pipe(\n      map((paramMap: ParamMap) => {\n        const id = paramMap.get('id');\n        return /^\\d+$/.test(id) ? parseInt(id, 10) : id;\n      })\n    );\n    this.user$ = idOrName$.pipe(\n      switchMap((id: string | number) => this.usersService.getSingle$(id)),\n      tap((user: IUserViewFull) => this.user = user)\n    );\n    this.id$ = this.user$.pipe(map((user: IUserViewFull) => user.meta.id));\n  }\n\n  public appendPage(page: number): void {\n    if (!this.isLoadingNextPage) {\n      this.isLoadingNextPage = true;\n      this.id$.pipe(\n        first(),\n        switchMap((author: number) => this.usersService.comments$(page, author, { ...extractQuery(this.selectedRange) })),\n        takeUntil(this.ngOnDestroy$)\n      ).subscribe((response: IPageResponse<ICommentViewFeed>) => {\n        this.isLoadingNextPage = false;\n        this.page = response.page;\n        this.maxPages = response.totalPages;\n        this.userComments.push(...response.content.filter((comment: ICommentViewFeed) => !comment.meta.deletedAt));\n      });\n    }\n  }\n\n  public rangeEvent(range: IToggleItem): void {\n    this.selectedRange = range;\n    this.activeRange = range?.id;\n    this.onFilter$.next(0);\n  }\n\n  public reset(): void {\n    this.page = 0;\n    this.maxPages = 1;\n    this.userComments = [];\n    this.appendPage(this.page);\n  }\n}\n","<app-user-header></app-user-header>\n\n<app-ranges [ranges]=\"ranges\"\n            [activeRange]=\"activeRange\"\n            (toggleRange)=\"rangeEvent($event)\"\n></app-ranges>\n\n<ul class=\"block-card item-space-20\">\n    <li *ngFor=\"let comment of userComments\">\n        <a class=\"font-1 h5 button-1\"\n           style=\"color: #000000;\"\n           [routerLink]=\"['/news', comment.context.meta.id]\"\n           [fragment]=\"'comment-' + comment.meta.id\"\n        >{{ comment.context.title }}</a>\n        <app-comment [attr.data-id]=\"comment.meta.id\"\n                     [comment]=\"comment\"\n                     [author]=\"user\"\n                     [depth]=\"3\"\n                     [parent]=\"comment.parent\"\n                     [extraStyle]=\"true\"\n                     (reply)=\"this.router.navigate(['/news', comment.context.meta.id])\"\n        ></app-comment>\n    </li>\n</ul>\n\n<app-pagination [page]=\"page\"\n                [maxPages]=\"maxPages\"\n                [enabled]=\"!isLoadingNextPage\"\n                (onPage)=\"appendPage($event)\"\n></app-pagination>\n","import { IToggleItem } from '@shared/interfaces/toggle-item.interface';\n\nexport function extractQuery<T, Q>(item: IToggleItem<T, Q>): Q | {} {\n    let result: Q | {};\n    if (!item || !item.query) {\n        result = {};\n    } else if (item.query instanceof Function) {\n        result = item.query();\n    } else {\n        result = item.query;\n    }\n    return result;\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { UserCommentsPageComponent } from './user-comments-page.component';\nimport { UsersResolverService } from '@shared/services/users-resolver.service';\n\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: UserCommentsPageComponent,\n    resolve: { data: UsersResolverService }\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class UserCommentsPageRoutingModule { }\n","export enum ECommentsRange {\n    RATING = 'RATING',\n    CREATED = 'CREATED'\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { UserCommentsPageRoutingModule } from './user-comments-page-routing.module';\nimport { UserCommentsPageComponent } from './user-comments-page.component';\nimport { SharedComponentsModule } from '@shared/components/shared-components.module';\nimport { UserHeaderModule } from '@modules/user/user-header/user-header.module';\nimport { SharedUiModule } from '@shared/ui/shared-ui.module';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { RangesModule } from '@shared/modules/ranges/ranges.module';\n\n\n@NgModule({\n  declarations: [UserCommentsPageComponent],\n  imports: [\n    CommonModule,\n    UserCommentsPageRoutingModule,\n    SharedComponentsModule,\n    UserHeaderModule,\n    SharedUiModule,\n    TranslateModule,\n    RangesModule\n  ]\n})\nexport class UserCommentsPageModule { }\n"],"sourceRoot":"webpack:///"}