{"version":3,"sources":["./src/app/shared/functions/fetch-articles-with-topics.function.ts","./src/app/modules/tags/pages/tag-page/tag-header/tag-header.component.ts","./src/app/modules/tags/pages/tag-page/tag-header/tag-header.component.html","./src/app/shared/classes/pageable-conetnt.class.ts","./src/app/shared/utils/not-found.operator.ts","./src/app/modules/tags/pages/tag-page/tag-page.component.ts","./src/app/modules/tags/pages/tag-page/tag-page.component.html","./src/app/modules/tags/pages/tag-page/tag-page-routing.module.ts","./src/app/modules/tags/pages/tag-page/tag-page.module.ts"],"names":[],"mappings":"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","file":"pages-tag-page-tag-page-module-es2015.js","sourcesContent":["import { Observable, of } from 'rxjs';\nimport { IArticleView } from '@api/schemas/article/article-view.interface';\nimport { IPageResponse } from '@api/schemas/page/page-response.interface';\nimport { ITopicView } from '@api/schemas/topic/topic-view.interface';\nimport { ITopicViewFull } from '@api/schemas/topic/topic-view-full.interface';\nimport { map, defaultIfEmpty } from 'rxjs/operators';\nimport { TopicsService } from '@api/routes/topics.service';\n\nexport function fetchArticlesWithTopics$(\n  page: IPageResponse<IArticleView>,\n  topicsService: TopicsService\n): Observable<IPageResponse<[IArticleView, ITopicView]>> {\n    const topics: number[] = [];\n    page.content.forEach((article: IArticleView) => {\n        if (article.topics.length > 0) {\n            topics.push(article.topics[0]);\n        }\n    });\n    return page.content.length > 0 ? topicsService.getMultiple$(topics).pipe(defaultIfEmpty([]), map((topicsRet: ITopicViewFull[]) => {\n        const content: [IArticleView, ITopicView][] = [];\n        page.content.forEach((article: IArticleView) => {\n            if (article.topics.length > 0) {\n                content.push([article, topicsRet.find((x: ITopicViewFull) => x.meta.id === article.topics[0]) as ITopicView]);\n            } else {\n                content.push([article, null]);\n            }\n        });\n        return { ...page, content };\n    })) : of({ ...page, content: [] });\n}\n","import { Component, Input } from '@angular/core';\nimport { ITagView } from '@api/schemas/tags/tag-view.interface';\nimport { Router } from '@angular/router';\n\n@Component({\n  selector: 'app-tag-header',\n  templateUrl: './tag-header.component.html',\n  styleUrls: ['./tag-header.component.scss']\n})\nexport class TagHeaderComponent {\n  @Input() public tag: ITagView;\n\n  constructor(\n    public readonly router: Router\n  ) { }\n}\n","<section class=\"tag-card margin-bottom-44\">\n    <app-ui-card [shadow]=\"false\">\n        <div *ngIf=\"tag\" class=\"current-tag\">\n            <span># {{ tag ? tag.content : 'Неизвестный тег' }}</span>\n            <div class=\"publications-info\">\n                <div *ngIf=\"tag\" class=\"stats-item\">\n                    {{ 'COMMON.PUBLICATIONS_' | translate}}\n                    <span class=\"stats-item__value\">{{ tag.postCount }}</span>\n                </div>\n                <div class=\"current-tag__menu\">\n                    <app-action-menu-tag *appLoggedIn [data]=\"tag\" (gone)=\"this.router.navigate(['/tags'])\"></app-action-menu-tag>\n                </div>\n            </div>\n        </div>\n    </app-ui-card>\n</section>\n","import { BehaviorSubject, Subject, Observable } from 'rxjs';\nimport { IPageResponse } from '@api/schemas/page/page-response.interface';\nimport { debounce, filter, first, tap, mapTo } from 'rxjs/operators';\n\nexport const NO_CONTENT = Symbol('NO_CONTENT');\n\nexport class PageableContent<T, O = any> {\n  public readonly isFetching$: BehaviorSubject<boolean> = new BehaviorSubject<boolean>(false);\n  public readonly content$: Subject<T[]> = new Subject<T[]>();\n  public readonly options$: BehaviorSubject<O>;\n  public readonly end$ = new Subject();\n\n  public content: T[] = [];\n  public page = -1;\n  public totalPages = 1;\n\n  private readonly fetchCommand$: Subject<never> = new Subject<never>();\n\n  constructor(\n    private readonly fetchNextFn$: (page: number, options: O) => Observable<IPageResponse<T>>,\n    options: O = null\n  ) {\n    this.options$ = new BehaviorSubject<O>(options);\n    this.fetchCommand$.pipe(debounce(() => this.isFetching$.pipe(filter((_: boolean) => !_)))).subscribe(() => this.fetchNextPage());\n  }\n\n  public fetch(): void {\n    if (this.page < this.totalPages - 1) {\n      this.fetchCommand$.next();\n    }\n  }\n\n  public reset$(hard: boolean = true): Observable<any> {\n    return this.isFetching$.pipe(\n      filter((it: boolean) => !it),\n      first(),\n      tap(() => {\n        if (hard) {\n          this.content.splice(0, this.content.length);\n        }\n        this.page = -1;\n        this.totalPages = 1;\n      }),\n    );\n  }\n\n  public setOptionsWithReset$(options: O, hard: boolean = true): Observable<O> {\n    return this.reset$(hard).pipe(\n      tap(() => {\n        this.options$.next(options);\n        this.fetch();\n      }),\n      mapTo(options),\n    );\n  }\n\n  private fetchNextPage(): void {\n    this.isFetching$.next(true);\n    this.fetchNextFn$(this.page + 1, this.options$.value).subscribe(\n      (response: IPageResponse<T>) => {\n        this.page = response.page;\n        this.totalPages = response.totalPages;\n        this.content$.next(response.content);\n        if (this.page >= this.totalPages - 1) {\n          this.end$.next();\n        }\n        this.content.push(...response.content);\n        this.isFetching$.next(false);\n      },\n      (error: any) => {\n        this.isFetching$.next(false);\n        if (error !== Symbol('NO_CONTENT')) {\n          throw error;\n        }\n      },\n    );\n  }\n}\n","import { OperatorFunction, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { Router } from '@angular/router';\n\nexport function notFound(router: Router): OperatorFunction<any, any> {\n    return catchError((error: HttpErrorResponse) => {\n        if (error.status === 404 || error.status === 422) {\n            router.navigateByUrl('/404');\n        }\n        return throwError(error);\n    });\n}\n","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { ReplaySubject, Observable, combineLatest } from 'rxjs';\nimport { ActivatedRoute, ParamMap, Router } from '@angular/router';\nimport { AbstractComponent } from '@shared/classes/abstract-component.class';\nimport { takeUntil, map, switchMap, filter } from 'rxjs/operators';\nimport { TagsService } from '@api/routes/tags.service';\nimport { ITagView } from '@api/schemas/tags/tag-view.interface';\nimport { PageableContent } from '@shared/classes/pageable-conetnt.class';\nimport { IArticleView } from '@api/schemas/article/article-view.interface';\nimport { IUserViewFull } from '@api/schemas/user/user-view-full.interface';\nimport { ITopicView } from '@api/schemas/topic/topic-view.interface';\nimport { IPageResponse } from '@api/schemas/page/page-response.interface';\nimport { FeedService } from '@api/routes/feed.service';\nimport { fetchArticlesWithTopics$ } from '@shared/functions/fetch-articles-with-topics.function';\nimport { TopicsService } from '@api/routes/topics.service';\nimport { SessionService } from '@app/services/session.service';\nimport { SidebarWrapperService } from '@layout/sidebar-wrapper/sidebar-wrapper.service';\nimport { notFound } from '@shared/utils/not-found.operator';\nimport { PlatformService } from '@shared/services/platform.service';\n\n@Component({\n  selector: 'app-tag-page',\n  templateUrl: './tag-page.component.html',\n  styleUrls: ['./tag-page.component.scss']\n})\nexport class TagPageComponent extends AbstractComponent implements OnInit, OnDestroy {\n  private readonly id$: ReplaySubject<number> = new ReplaySubject<number>(1);\n\n  public readonly tag$: ReplaySubject<ITagView> = new ReplaySubject<ITagView>();\n  public readonly pageable: PageableContent<[IArticleView, ITopicView], [number, IUserViewFull]> =\n    new PageableContent<[IArticleView, ITopicView], [number, IUserViewFull]>(this.fetch$.bind(this));\n\n  constructor(\n    private readonly activatedRoute: ActivatedRoute,\n    private readonly tagsService: TagsService,\n    private readonly feedService: FeedService,\n    private readonly topicsService: TopicsService,\n    private readonly sessionService: SessionService,\n    private readonly sidebarWrapperService: SidebarWrapperService,\n    private readonly platformService: PlatformService,\n    public readonly router: Router,\n  ) {\n    super();\n  }\n\n  ngOnInit(): void {\n    setTimeout(() => {\n      this.sidebarWrapperService.params$.next({ article: false, trending: true, navigation: true, live: false, showSidebar: true });\n    });\n\n    this.activatedRoute.paramMap.pipe(\n      map((_: ParamMap) => +_.get('id')),\n      takeUntil(this.ngOnDestroy$),\n    ).subscribe(this.id$);\n\n    this.id$.pipe(\n      switchMap((id: number) => this.tagsService.getSingle$(id)),\n      notFound(this.router),\n      takeUntil(this.ngOnDestroy$)\n    ).subscribe(this.tag$);\n\n    const options$: Observable<[number, IUserViewFull]> = combineLatest([this.id$, this.sessionService.user$]);\n\n    options$.pipe(\n      switchMap((opts: [number, IUserViewFull]) => this.pageable.setOptionsWithReset$(opts)),\n      takeUntil(this.ngOnDestroy$)\n    ).subscribe();\n\n    options$.pipe(\n      filter((_: [number, IUserViewFull]) => !!_[1]),\n      switchMap(([id]: [number, IUserViewFull]) => this.tagsService.markAsViewed$(id)),\n      takeUntil(this.ngOnDestroy$)\n    ).subscribe();\n\n    if (this.platformService.isServer) {\n      this.pageable.content = this.activatedRoute.snapshot.data.feed;\n    }\n  }\n\n  public fetch$(page: number, options: [number, IUserViewFull]): Observable<IPageResponse<[IArticleView, ITopicView]>> {\n    return this.feedService.feedRequest$({ page, tag: options ? options[0] : undefined }).pipe(\n      switchMap((_: IPageResponse<IArticleView>) => fetchArticlesWithTopics$(_, this.topicsService)),\n      takeUntil(this.ngOnDestroy$),\n    );\n  }\n}\n","<app-tag-header [tag]=\"tag$ | async\"></app-tag-header>\n<section>\n    <ul *ngIf=\"pageable.content\" class=\"block-card item-space-40\">\n        <li *ngFor=\"let article of pageable.content; let i = index\">\n            <app-feed-article-view [data]=\"article[0]\" [topic]=\"article[1]\" [options]=\"{ pictureOn: true, menuOn: true }\"></app-feed-article-view>\n        </li>\n    </ul>\n    <p *ngIf=\"!pageable.content\">{{'COMMON.TAGS_NOT_FOUND' | translate}</p>\n</section>\n\n<app-pagination [pageable]=\"pageable\"></app-pagination>\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { TagPageComponent } from './tag-page.component';\nimport { FeedResolverService } from '@shared/services/feed-resolver.service';\n\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: TagPageComponent,\n    resolve: { feed: FeedResolverService }\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class TagPageRoutingModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { TagPageRoutingModule } from './tag-page-routing.module';\nimport { TagPageComponent } from './tag-page.component';\nimport { TagHeaderComponent } from './tag-header/tag-header.component';\nimport { SharedUiModule } from '@shared/ui/shared-ui.module';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { FeedModule } from '@shared/modules/feed/feed.module';\nimport { SharedComponentsModule } from '@shared/components/shared-components.module';\nimport { CommonDirectivesModule } from '@shared/directives/directives.module';\n\n\n@NgModule({\n  declarations: [TagPageComponent, TagHeaderComponent],\n  imports: [\n    CommonModule,\n    TagPageRoutingModule,\n    SharedUiModule,\n    TranslateModule.forChild(),\n    FeedModule,\n    SharedComponentsModule,\n    CommonDirectivesModule\n  ]\n})\nexport class TagPageModule { }\n"],"sourceRoot":"webpack:///"}