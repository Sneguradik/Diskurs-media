{"version":3,"sources":["webpack:///src/app/modules/user/pages/user-comments-page/user-comments-page.component.ts","webpack:///src/app/modules/user/pages/user-comments-page/user-comments-page.component.html","webpack:///src/app/shared/functions/extract-query.function.ts","webpack:///src/app/modules/user/pages/user-comments-page/user-comments-page-routing.module.ts","webpack:///src/app/shared/enums/comments-range.enum.ts","webpack:///src/app/modules/user/pages/user-comments-page/user-comments-page.module.ts"],"names":["UserCommentsPageComponent","usersService","activatedRoute","sidebarWrapperService","translateService","router","onFilter$","ranges","id","text","instant","query","order","CREATED","RATING","activeRange","selectedRange","userComments","maxPages","page","isLoadingNextPage","ngOnInit","setTimeout","params$","next","article","trending","navigation","live","showSidebar","pipe","ngOnDestroy$","subscribe","reset","idOrName$","paramMap","get","test","parseInt","user$","getSingle$","user","id$","meta","appendPage","author","comments$","response","totalPages","push","content","filter","comment","deletedAt","rangeEvent","range","selector","templateUrl","styleUrls","extractQuery","item","result","Function","routes","path","component","resolve","data","UserCommentsPageRoutingModule","forChild","imports","exports","ECommentsRange","UserCommentsPageModule","declarations"],"mappings":"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","file":"pages-user-comments-page-user-comments-page-module-es5.js","sourcesContent":["import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { ICommentViewFeed } from '@api/schemas/comment/comment-view-feed.interface';\nimport { Observable, Subject } from 'rxjs';\nimport { AbstractComponent } from '@shared/classes/abstract-component.class';\nimport { UsersService } from '@api/routes/users.service';\nimport { ActivatedRoute, Router, ParamMap } from '@angular/router';\nimport { IUserViewFull } from '@api/schemas/user/user-view-full.interface';\nimport { takeUntil, map, first, switchMap, tap } from 'rxjs/operators';\nimport { IPageResponse } from '@api/schemas/page/page-response.interface';\nimport { SidebarWrapperService } from '@layout/sidebar-wrapper/sidebar-wrapper.service';\nimport { IToggleItem } from '@shared/interfaces/toggle-item.interface';\nimport { ECommentsRange } from '@shared/enums/comments-range.enum';\nimport { TranslateService } from '@ngx-translate/core';\nimport { extractQuery } from '@shared/functions/extract-query.function';\n\n@Component({\n  selector: 'app-user-comments-page',\n  templateUrl: './user-comments-page.component.html',\n  styleUrls: ['./user-comments-page.component.scss']\n})\nexport class UserCommentsPageComponent extends AbstractComponent implements OnInit, OnDestroy {\n  private readonly onFilter$: Subject<number> = new Subject<number>();\n\n  public readonly ranges: IToggleItem<ECommentsRange, { order: ECommentsRange }>[] = [\n    {\n      id: 0,\n      text: this.translateService.instant('COMMON.BY_ORDER'),\n      query: () => ({\n        order: ECommentsRange.CREATED\n      })\n    },\n    {\n      id: 1,\n      text: this.translateService.instant('COMMON.POPULAR_FIRST'),\n      query: () => ({\n        order: ECommentsRange.RATING\n      })\n    }\n  ];\n\n  public activeRange = 0;\n  public selectedRange: IToggleItem = this.ranges[0];\n  public userComments: ICommentViewFeed[] = [];\n  public maxPages = 0;\n  public page = 0;\n  public isLoadingNextPage = false;\n  public user$: Observable<IUserViewFull>;\n  public id$: Observable<number>;\n  public user: IUserViewFull;\n\n  constructor(\n    private readonly usersService: UsersService,\n    private readonly activatedRoute: ActivatedRoute,\n    private readonly sidebarWrapperService: SidebarWrapperService,\n    private readonly translateService: TranslateService,\n    public readonly router: Router,\n  ) {\n    super();\n  }\n\n  ngOnInit(): void {\n    setTimeout(() => {\n      this.sidebarWrapperService.params$.next({ article: false, trending: true, navigation: true, live: false, showSidebar: true });\n    });\n\n    this.onFilter$.pipe(takeUntil(this.ngOnDestroy$)).subscribe(() => this.reset());\n\n    const idOrName$: Observable<string | number> = this.activatedRoute.paramMap.pipe(\n      map((paramMap: ParamMap) => {\n        const id = paramMap.get('id');\n        return /^\\d+$/.test(id) ? parseInt(id, 10) : id;\n      })\n    );\n    this.user$ = idOrName$.pipe(\n      switchMap((id: string | number) => this.usersService.getSingle$(id)),\n      tap((user: IUserViewFull) => this.user = user)\n    );\n    this.id$ = this.user$.pipe(map((user: IUserViewFull) => user.meta.id));\n  }\n\n  public appendPage(page: number): void {\n    if (!this.isLoadingNextPage) {\n      this.isLoadingNextPage = true;\n      this.id$.pipe(\n        first(),\n        switchMap((author: number) => this.usersService.comments$(page, author, { ...extractQuery(this.selectedRange) })),\n        takeUntil(this.ngOnDestroy$)\n      ).subscribe((response: IPageResponse<ICommentViewFeed>) => {\n        this.isLoadingNextPage = false;\n        this.page = response.page;\n        this.maxPages = response.totalPages;\n        this.userComments.push(...response.content.filter((comment: ICommentViewFeed) => !comment.meta.deletedAt));\n      });\n    }\n  }\n\n  public rangeEvent(range: IToggleItem): void {\n    this.selectedRange = range;\n    this.activeRange = range?.id;\n    this.onFilter$.next(0);\n  }\n\n  public reset(): void {\n    this.page = 0;\n    this.maxPages = 1;\n    this.userComments = [];\n    this.appendPage(this.page);\n  }\n}\n","<app-user-header></app-user-header>\n\n<app-ranges [ranges]=\"ranges\"\n            [activeRange]=\"activeRange\"\n            (toggleRange)=\"rangeEvent($event)\"\n></app-ranges>\n\n<ul class=\"block-card item-space-20\">\n    <li *ngFor=\"let comment of userComments\">\n        <a class=\"font-1 h5 button-1\"\n           style=\"color: #000000;\"\n           [routerLink]=\"['/news', comment.context.meta.id]\"\n           [fragment]=\"'comment-' + comment.meta.id\"\n        >{{ comment.context.title }}</a>\n        <app-comment [attr.data-id]=\"comment.meta.id\"\n                     [comment]=\"comment\"\n                     [author]=\"user\"\n                     [depth]=\"3\"\n                     [parent]=\"comment.parent\"\n                     [extraStyle]=\"true\"\n                     (reply)=\"this.router.navigate(['/news', comment.context.meta.id])\"\n        ></app-comment>\n    </li>\n</ul>\n\n<app-pagination [page]=\"page\"\n                [maxPages]=\"maxPages\"\n                [enabled]=\"!isLoadingNextPage\"\n                (onPage)=\"appendPage($event)\"\n></app-pagination>\n","import { IToggleItem } from '@shared/interfaces/toggle-item.interface';\n\nexport function extractQuery<T, Q>(item: IToggleItem<T, Q>): Q | {} {\n    let result: Q | {};\n    if (!item || !item.query) {\n        result = {};\n    } else if (item.query instanceof Function) {\n        result = item.query();\n    } else {\n        result = item.query;\n    }\n    return result;\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { UserCommentsPageComponent } from './user-comments-page.component';\nimport { UsersResolverService } from '@shared/services/users-resolver.service';\n\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: UserCommentsPageComponent,\n    resolve: { data: UsersResolverService }\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class UserCommentsPageRoutingModule { }\n","export enum ECommentsRange {\n    RATING = 'RATING',\n    CREATED = 'CREATED'\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { UserCommentsPageRoutingModule } from './user-comments-page-routing.module';\nimport { UserCommentsPageComponent } from './user-comments-page.component';\nimport { SharedComponentsModule } from '@shared/components/shared-components.module';\nimport { UserHeaderModule } from '@modules/user/user-header/user-header.module';\nimport { SharedUiModule } from '@shared/ui/shared-ui.module';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { RangesModule } from '@shared/modules/ranges/ranges.module';\n\n\n@NgModule({\n  declarations: [UserCommentsPageComponent],\n  imports: [\n    CommonModule,\n    UserCommentsPageRoutingModule,\n    SharedComponentsModule,\n    UserHeaderModule,\n    SharedUiModule,\n    TranslateModule,\n    RangesModule\n  ]\n})\nexport class UserCommentsPageModule { }\n"]}